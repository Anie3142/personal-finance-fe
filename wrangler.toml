# Cloudflare Workers configuration for Next.js app
# Deployed via Jenkins CI/CD pipeline

name = "personal-finance-fe"
main = ".open-next/worker.js"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat"]

# Static assets configuration for Next.js
[assets]
directory = ".open-next/assets"
binding = "ASSETS"

# Environment variables for production
[vars]
# Public Auth0 Configuration (non-secret)
NEXT_PUBLIC_AUTH0_DOMAIN = "dev-54nxe440ro81hlb6.us.auth0.com"
NEXT_PUBLIC_AUTH0_CLIENT_ID = "SM3sFfXc1ntYVIeWY1g16pVnuSsYUI7k"
NEXT_PUBLIC_AUTH0_REDIRECT_URI = "https://personal-finance.namelesscompany.cc"

# API Configuration
NEXT_PUBLIC_API_BASE_URL = "https://personal-finance-api.namelesscompany.cc/api/v1"

# Auth0 SDK Configuration (server-side)
AUTH0_BASE_URL = "https://personal-finance.namelesscompany.cc"
AUTH0_ISSUER_BASE_URL = "https://dev-54nxe440ro81hlb6.us.auth0.com"
AUTH0_CLIENT_ID = "SM3sFfXc1ntYVIeWY1g16pVnuSsYUI7k"
AUTH0_AUDIENCE = "https://api.personal-finance.namelesscompany.cc"

# NOTE: Secret values must be set via wrangler CLI:
# wrangler secret put AUTH0_SECRET
# wrangler secret put AUTH0_CLIENT_SECRET

# KV bindings for Next.js cache (optional - for production caching)
# [[kv_namespaces]]
# binding = "NEXT_CACHE_WORKERS_KV"
# id = "<your-kv-namespace-id>"

# Custom domain - Workers will respond to this domain
# This automatically creates DNS record and SSL certificate
# Required API Token Permission: Zone > Workers Routes > Edit
[[routes]]
pattern = "personal-finance.namelesscompany.cc"
custom_domain = true
