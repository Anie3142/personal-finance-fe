# Cloudflare Workers configuration for Next.js app
# Deployed via Jenkins CI/CD pipeline

name = "personal-finance-fe"
main = ".open-next/worker.js"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat"]

# Static assets configuration for Next.js
[assets]
directory = ".open-next/assets"
binding = "ASSETS"

# Environment variables for production
# All client-side variables use NEXT_PUBLIC_ prefix
[vars]
# Auth0 Configuration (client-side SPA)
NEXT_PUBLIC_AUTH0_DOMAIN = "dev-54nxe440ro81hlb6.us.auth0.com"
NEXT_PUBLIC_AUTH0_CLIENT_ID = "SM3sFfXc1ntYVIeWY1g16pVnuSsYUI7k"
NEXT_PUBLIC_AUTH0_AUDIENCE = "https://personal-finance-api.namelesscompany.cc"
NEXT_PUBLIC_AUTH0_REDIRECT_URI = "https://personal-finance.namelesscompany.cc"

# API Configuration
NEXT_PUBLIC_API_BASE_URL = "https://personal-finance-api.namelesscompany.cc/api/v1"

# NOTE: No server-side secrets needed for client-side SPA auth!
# The client-side SDK uses PKCE flow which doesn't require a client secret.

# KV bindings for Next.js cache (optional - for production caching)
# [[kv_namespaces]]
# binding = "NEXT_CACHE_WORKERS_KV"
# id = "<your-kv-namespace-id>"

# Custom domain - Workers will respond to this domain
# This automatically creates DNS record and SSL certificate
# Required API Token Permission: Zone > Workers Routes > Edit
[[routes]]
pattern = "personal-finance.namelesscompany.cc"
custom_domain = true
